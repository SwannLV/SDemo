{"ts":1351831602152,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":true,"ts":1351831624490,"patch":[[{"diffs":[[1,"/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.MaskPass = function ( scene, camera ) {\r\n\r\n    this.scene = scene;\r\n\tthis.camera = camera;\r\n\r\n\tthis.enabled = true;\r\n\tthis.clear = true;\r\n\tthis.needsSwap = false;\r\n\r\n\tthis.inverse = false;\r\n\r\n};\r\n\r\nTHREE.MaskPass.prototype = {\r\n\r\n\trender: function ( renderer, writeBuffer, readBuffer, delta ) {\r\n\r\n\t\tvar context = renderer.context;\r\n\r\n\t\t// don't update color or depth\r\n\r\n\t\tcontext.colorMask( false, false, false, false );\r\n\t\tcontext.depthMask( false );\r\n\r\n\t\t// set up stencil\r\n\r\n\t\tvar writeValue, clearValue;\r\n\r\n\t\tif ( this.inverse ) {\r\n\r\n\t\t\twriteValue = 0;\r\n\t\t\tclearValue = 1;\r\n\r\n\t\t} else {\r\n\r\n\t\t\twriteValue = 1;\r\n\t\t\tclearValue = 0;\r\n\r\n\t\t}\r\n\r\n\t\tcontext.enable( context.STENCIL_TEST );\r\n\t\tcontext.stencilOp( context.REPLACE, context.REPLACE, context.REPLACE );\r\n\t\tcontext.stencilFunc( context.ALWAYS, writeValue, 0xffffffff );\r\n\t\tcontext.clearStencil( clearValue );\r\n\r\n\t\t// draw into the stencil buffer\r\n\r\n\t\trenderer.render( this.scene, this.camera, readBuffer, this.clear );\r\n\t\trenderer.render( this.scene, this.camera, writeBuffer, this.clear );\r\n\r\n\t\t// re-enable update of color and depth\r\n\r\n\t\tcontext.colorMask( true, true, true, true );\r\n\t\tcontext.depthMask( true );\r\n\r\n\t\t// only render where stencil is set to 1\r\n\r\n\t\tcontext.stencilFunc( context.EQUAL, 1, 0xffffffff );  // draw if == 1\r\n\t\tcontext.stencilOp( context.KEEP, context.KEEP, context.KEEP );\r\n\r\n\t}\r\n\r\n};\r\n\r\n\r\nTHREE.ClearMaskPass = function () {\r\n\r\n\tthis.enabled = true;\r\n\r\n};\r\n\r\nTHREE.ClearMaskPass.prototype = {\r\n\r\n\trender: function ( renderer, writeBuffer, readBuffer, delta ) {\r\n\r\n\t\tvar context = renderer.context;\r\n\r\n\t\tcontext.disable( context.STENCIL_TEST );\r\n\r\n\t}\r\n\r\n};"]],"start1":0,"start2":0,"length1":0,"length2":1709}]],"length":1709,"saved":false}
